<html>
	<head>
		<meta charset="UTF-8"> 
		<title>GeeMail E-mail Client</title>
		<script src="js/mail-generator.js"></script>
		<link rel="icon" type="image/png" href="css/img/favicon-32x32.png" sizes="32x32" />
		<link rel="icon" type="image/png" href="css/img/favicon-16x16.png" sizes="16x16" />
		<link href="css/style.css" rel="stylesheet" media="screen">
    <script>
      window.onload = function(){
        // ALL OF YOUR JAVASCRIPT CODE SHOULD GO HERE. 
        // We have to use window.onload so your JavaScript doesn't execute until the page has loaded and all HTML has been downloaded to your browser
			
		// Unread Messages Count
		var initMessageCount = window.geemails.length;
		var UnreadMessageCount = 0;
		var loadedMsgs = 0;
		var maxInboxSize = 25;
		var newElement = null;
		var newMessage = {container:null, subject:null, sender:null, messageBody:null, messageDate:null};


		updateMsgCount();
		initAddMessage();
		
		function updateMsgCount() {
			document.getElementById("unreadMsgCount").innerHTML = UnreadMessageCount.toLocaleString();
		}
		
		function incrementMsgCount() {
			UnreadMessageCount += 1;
			loadedMsgs += 1;
			updateMsgCount();
		}
		
		function decrementMsgCount() {
			UnreadMessageCount -= 1;
			updateMsgCount();
		}
		
		function initAddMessage() {
			for(var i = 0; i < initMessageCount; i++){
				if (loadedMsgs < maxInboxSize) {
					// Update inbox count
					incrementMsgCount();
					newMessage.container = document.createElement('div');
					newMessage.container.className = "message";
					// Create the content of the message, including classes for anything which needs specific styles.
					//Buttons
					newMessage.container.innerHTML = "<button class='msgButton' id='msgShowButton" + loadedMsgs + "'onclick='document.getElementById(&#39;messageBody" + loadedMsgs + "&#39;).style.display=&#39;inline&#39;'>Show Message</button><button class='msgButton' id='msgHideButton" + loadedMsgs + "'onclick='document.getElementById(&#39;messageBody" + loadedMsgs + "&#39;).style.display=&#39;none&#39;'>Hide Message</button>";
					msgContainer.appendChild(newMessage.container);
					
					//Subject
					newMessage.subject = document.createElement('span');
					newMessage.subject.className = "messageSubject";
					newMessage.subject.innerHTML = "Subject: <span class='messageSubjectInner'>" + window.geemails[i].subject + "</span>";
					newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
					newElement.appendChild(newMessage.subject);
					
					//Sender
					newMessage.sender = document.createElement('span');
					newMessage.sender.className = "messageSender";
					newMessage.sender.innerHTML = "Sender: <span class='messageSenderInner'>" + window.geemails[i].sender + "</span>";
					newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
					newElement.appendChild(newMessage.sender);
					
					//Date
					newMessage.date = document.createElement('span');
					newMessage.date.className = "messageDate";
					newMessage.date.innerHTML = "Date: <span class='messageDateInner'>" + window.geemails[i].date + "</span>" + "<br/>";
					newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
					newElement.appendChild(newMessage.date);
					
					//Body
					newMessage.body = document.createElement('span');
					newMessage.body.id = "messageBody" + loadedMsgs;
					newMessage.body.className = "messageBody";
					newMessage.body.innerHTML = "<br/>" + window.geemails[i].body + "<hr/>";
					newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
					newElement.appendChild(newMessage.body);
				}
			}
		}

		// Adds a new message at a random interval spanning 1 to 10 seconds (this is set only once), until we reach maxInboxSize.
		var interval = setInterval(addMessage, ((Math.random() * 9000) + 1000));

		function resetInterval() {
			clearInterval(interval);
			interval = setInterval(addMessage, ((Math.random() * 9000) + 1000));
		}

		function addMessage() {
			if (loadedMsgs < maxInboxSize) {

				// Update inbox count
				incrementMsgCount();
				newMessage = document.createElement('div');
				newMessage.className = "message";
				// Create the content of the message, including classes for anything which needs specific styles.
				//Buttons
				newMessage.innerHTML = "<button class='msgButton' id='msgShowButton" + loadedMsgs + "'onclick='document.getElementById(&#39;messageBody" + loadedMsgs + "&#39;).style.display=&#39;inline&#39;'>Show Message</button><button class='msgButton' id='msgHideButton" + loadedMsgs + "'onclick='document.getElementById(&#39;messageBody" + loadedMsgs + "&#39;).style.display=&#39;none&#39;'>Hide Message</button>";
				msgContainer.appendChild(newMessage);
					
				//Subject
				newMessage.subject = document.createElement('span');
				newMessage.subject.className = "messageSubject";
				newMessage.subject.innerHTML = "Subject: <span class='messageSubjectInner'>" + getNewMessage().subject + "</span>";
				newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
				newElement.appendChild(newMessage.subject);
					
				//Sender
				newMessage.sender = document.createElement('span');
				newMessage.sender.className = "messageSender";
				newMessage.sender.innerHTML = "Sender: <span class='messageSenderInner'>" + getNewMessage().sender + "</span>";
				newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
				newElement.appendChild(newMessage.sender);
					
				//Date
				newMessage.date = document.createElement('span');
				newMessage.date.className = "messageDate";
				newMessage.date.innerHTML = "Date: <span class='messageDateInner'>" + getNewMessage().date + "</span>" + "<br/>";
				newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
				newElement.appendChild(newMessage.date);
					
				//Body
				newMessage.body = document.createElement('span');
				newMessage.body.id = "messageBody" + loadedMsgs;
				newMessage.body.className = "messageBody";
				newMessage.body.innerHTML = "<br/>" + getNewMessage().body + "<hr/>";
				newElement = document.getElementsByClassName("message")[(loadedMsgs - 1)];
				newElement.appendChild(newMessage.body);

				resetInterval();
			}
		}

      };
    </script>
	</head>
	<body>
	
	<label id for="nightMode">Night Mode</label>
	<input type="checkbox" id="nightMode">
	
	<div class="main">
		
		<div id="headerImg">
		</div>
		
		<hr/ id="headerEnd">
		
		<div id="mainBody">
			<p id="unreadMsg">You have <span id="unreadMsgCount">0</span> unread message(s)!</p>
						
			<div id="msgContainer">
			</div>
			
		</div>
		
		<div id = "footer">
			<!-- NOTE: Find way to prevent this from going up too high on page -->
			<p>Copyright 2013-2016 <a href="https://github.com/Souzooka/">Geegle</a></p>
		</div>
		
	</div>
	</body>
</html>